<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=devce-width, initial-scale=1">
    <title>Manual Concepts</title>
    <style>
        @font-face {
            font-family: RodinNTLG;
            src: url("/assets/fonts/CTRNTLG-DB-0001.ttf") format("truetype");
        }
        :root {
            --index-bar-width: 300px;
            --index-bar-off: 0px;
            --pageheader-border-radius: 12px;
        }

        ::-webkit-scrollbar {
            width: 6px;
            background-color: transparent;
        }
        ::-webkit-scrollbar-thumb {
            border-radius: 100vw;
            background-color: white;
            min-height: 32px;
        }
        body {
            background: rgb(32, 36, 52);
            color: rgb(32, 36, 52);
            margin: 0;
            font-size: 14px;
        }
        div#content {
            max-width: 100vw;
            max-height: 100vw;
            overflow: hidden;
            padding: 0;
            margin: 0;
        }
        body, button {
            font-family: RodinNTLG, "nintendo_NTLG-DB_002", "nintendo_NTLG-DB_001", sans-serif;
        }
        hr {
            margin: 8px 7px 8px 0px;
            margin-left: 7px;
            border: none;
            width: calc(100% - 14px);
            height: 2px;
            background-color: rgba(64,64,64,.5);
        }
        #index {
            position: fixed;
            display: flex;
            flex-direction: column;
            width: var(--index-bar-width);
            height: calc(100% - 16pt);
            padding: 8pt 0pt;
            left: var(--index-bar-off);
            opacity: 1;
            transition: all 333ms ease-in-out;
            top: 0px;
            border-radius: 0px 12pt 12pt 0;
            background-color: rgba(255, 255, 255, .75);
            backdrop-filter: blur(3pt);
            box-shadow: 0px 0px 12pt black;
            overflow: hidden;
        }
        #index.hidden {
            box-shadow: 0px 0px 0pt black;
            background-color: rgba(255, 255, 255, 1);
            opacity: 0;
        }

        #page {
            position: fixed;
            display: flex;
            flex-flow: column;
            transition: width 500ms ease-in-out;
            width: calc(100vw - var(--index-bar-width) - var(--index-bar-off) + 16px);
            min-width: 336px;
            max-width: calc(100vw + 16px);
            height: 100%;
            right: -16px;
            top: 0px;
            user-select: none;
            overflow: hidden;
        }

        #pageHeader {
            transition: background-color 250ms ease, border-radius 333ms ease, box-shadow 500ms ease;
            align-self: center;
            background: linear-gradient(176.6deg, #fff2 0%, #fff8 45%, #fff0 55%, #fff4 100%);
            background-color: rgba(64, 72, 96, 0.5);
            position: absolute;
            display: flex;
            flex-flow: row;
            backdrop-filter: blur(3px);
            top: 0px;
            width: 320px;
            margin-right: 16px;
            height: 40px;
            border-radius: 0 0 var(--pageheader-border-radius) var(--pageheader-border-radius);
            box-shadow: 0px 0px 12px black;
            vertical-align: baseline;
        }
        .currPageLabel {
            padding: 3px;
        }
        #pageHeader:hover {
            background-color: rgba(160, 255, 255, .5);
        }
        #pageHeader:active {
            background-color: rgba(128, 160, 192, .5);
        }

        .pageCount {
            display: table-cell;
            margin: 6px;
            width: 28px;
            height: 28px;
            border-radius: 8px;
            background: royalblue;
            color: white;
            align-self: top;
        }

        .cat1 {background: #e88480;}
        .cat2 {background: #98d068;}
        .cat3 {background: #70b4d8;}
        .cat4 {background: #e0c858;}
        .cat5 {background: #9888d0;}
        .cat6 {background: #b0b860;}
        .cat7 {background: #90a8e8;}
        .cat8 {background: #e89070;}
        .cat9 {background: #78ccb0;}
        .cat10 {background: #d09cd0;}
        .cat11 {background: #d8b060;}
        .cat12 {background: #a0bcb8;}

        .pageCount div {
            display: table-cell;
            vertical-align: middle;
            text-align: center;
            width: 28px;
            height: 28px;
            text-shadow:
                0pt 0.0pt 0.5pt #000,
                0pt 0.125pt 1.0pt #000,
                0pt 0.25pt 1.5pt #000,
                0pt 0.5pt 2pt #000;
        }

        #pageHeader .pageCount {
            box-shadow:
                0px 0px 4px white,
                0px 0px 4px white;
        }

        .pageLabel div {
            display: table-cell;
            height: 32px;
            padding: 4px 4px;
            vertical-align: middle;
            overflow-x: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
            max-width: calc(320px - 50px);
            text-shadow:
                -1.5px  1.5px 2px white,
                 0.0px  2.0px 2px white,
                 1.5px  1.5px 2px white,
                -2.0px  0.0px 2px white,
                 2.0px  0.0px 2px white,
                -1.5px -1.5px 2px white,
                 0.0px -2.0px 2px white,
                 1.5px -1.5px 2px white,
                 0.0px  4.0px 4px white;
        }

        #page iframe {
            position: absolute;
            top: -40px;
            margin-top: 40px;
            width: 336px;
            height: 100%;
            background-color: clear;
            border: none;
            align-self: center;
            transition: opacity 125ms ease;
            opacity: 1;
        }
        #page iframe.hidden {
            opacity: 0;
        }

        #pageList, #langList {
            display: block;
            width: calc(100% - 16pt);
            flex-grow: 1;
            overflow-y: hidden;
            margin: 8pt;
            transition: opacity 125ms ease;
            opacity: 1;
            padding: 0;
            background: #0004;
            border-radius: 4px;
        }
        #pageList.hidden, #langList.hidden {
            opacity: 0;
        }

        #pageList .listcontent, #langList .listcontent {
            width: calc(100% - 8pt);
            height: calc(100% - 16pt);
            scrollbar-gutter: both-edges stable;
            scrollbar-color: white transparent;
            overflow-x: hidden;
            overflow-y: scroll;
            padding: 8pt 4pt;
        }

        #pageList .category {
            display: flex;
            flex-flow: row;
            height: 20px;
            text-align: center;
            border: none;
            border-radius: 8pt;
            padding: 4px 0pt;
            margin: 4px 0pt;
            text-shadow: 0pt 1pt 2pt #000;
            box-shadow: 0px -9px 12px #0008 inset;
            color: white;
        }

        #pageList .category div {
            display: block;
            width: calc(100% - 8pt);
            padding: 4pt 4pt;
            align-self: center;
            color: white;
            text-overflow: ellipsis;
            white-space: nowrap;
            overflow-x: hidden;
        }
        #pageList .category div.dowrap {
            white-space: unset;
        }

        #pageList .listcontent button, #langList .listcontent button {
            width: 100%;
            transition:
                transform 100ms ease,
                box-shadow 100ms ease,
                color 100ms ease,
                background-color 100ms ease;
            display: flex;
            flex-flow: row;
            border: none;
            border-radius: 8pt;
            padding: 0pt;
            margin: 4px 0pt;
            font-size: 14px;
            box-shadow: 0px -2pt 6pt #0008 inset, 0px 2px 4px #0008;
            background-color: #EEE;
            color: #333;
            text-align: left;
        }
        #pageList .listcontent button:hover, #langList .listcontent button:hover {
            background-color: white;
            box-shadow: 0px -1pt 3pt #0008 inset, 0px 3px 4px #000a;
            color: #555;
        }
        #pageList .listcontent button:active, #langList .listcontent button:active {
            background-color: #AAA;
            box-shadow: 0px -3pt 9pt #0008 inset, 0px 0px 0px #000;
            color: black;
            transform: scale(.9875) translateY(2px);
        }

        .indexButtons {
            display: flex;
            flex-flow: row;
            margin: 0px 8pt;
        }
        
        .langButtons {
            display: flex;
            flex-flow: row;
            margin: 4pt 0px;
            margin-left: 10pt;
        }
        
        #indexToggle, .closeBtn {
            width: calc(100% - 16pt);
            display: block;
            border: none;
            border-radius: 8pt;
            padding: 4pt;
            margin: 0px 4pt;
            font-size: 14px;
            background-color: #444;
            box-shadow: 0px 0px 8px gray inset, 0px 0px 4px black;
            color: white;
        }
        #indexToggle:hover, .closeBtn:hover {
            background-color: #555;
        }
        #indexToggle:active, .closeBtn:active {
            background-color: #333;
            color: silver;
        }

        #indexGetLang, .whiteBtn {
            width: calc(100% - 16pt);
            display: block;
            border: none;
            border-radius: 8pt;
            padding: 4pt;
            margin: 0px 4pt;
            font-size: 14px;
            background-color: #EEE;
            box-shadow: 0px 0px 8px white inset, 0px 0px 4px black;
            color: #333;
        }
        #indexGetLang:hover, .whiteBtn:hover {
            background-color: white;
        }
        #indexGetLang:active, .whiteBtn:active {
            background-color: silver;
            color: #111;
        }

        #pageList .listcontent button *, #langList .listcontent button * {
            align-self: center;
        }

        #pageList .pageLabel, #langList .pageLabel {
            max-width: calc(100% - 44px);
            text-overflow: ellipsis;
            overflow-x: hidden;
            padding: 6px 0px;
        }
        .pageBtnContainer {
            align-self: center;
            position: absolute;
            display: flex;
            flex-flow: row;
            bottom: 0px;
            width: 320px;
            margin-right: 16px;
            height: 32px;
            border-radius: 12px;
            box-shadow: 0px 0px 12px black;
            vertical-align: baseline;
        }
        .pageBtnContainer button {
            width: 100%;
            border: none;
            border-left: 1px #fff4 solid;
            border-right: 1px #0004 solid;
            color: #222;
            text-shadow: 0px 1px 0px white;
            font-size: 14px;
            background: linear-gradient(180deg, #e8f0ff 0%, #989ca0 100%);
        }
        .pageBtnContainer button:active {
            border-top: 2px gray solid;
            background: linear-gradient(180deg, #303840 0%, #889098 100%);
            color: white;
            text-shadow: 0px -1px 0px black;
        }
        .pageBtnContainer button:disabled {
            background: gray;
            color: #666;
            text-shadow: none;
        }
        #pageBtnPrev {
            border-radius: 12px 0 0 0;
        }
        #pageBtnNext {
            border-radius: 0 12px 0 0;
        }

        #langSel {
            position: fixed;
            display: flex;
            flex-flow: column;
            transition:
                right 333ms ease-out,
                opacity 250ms ease;
            backdrop-filter: blur(4pt);
            background: #cccc;
            box-shadow: 0px 0px 8px black, 0px 0px 16px white inset;
            width: calc(100% - 20px);
            height: calc(100% - 20px);
            bottom: 0%;
            padding: 10px;
            overflow: hidden;
            right: 0%;
            opacity: 1;
        }
        #langSel.hidden {
            right: -100%;
            opacity: 0;
        }

        .hdrspecial {
            color: transparent;
            background: linear-gradient(15deg, #cf0 0%, #08f 100%);
            background-clip: text;
            -webkit-background-clip: text;
            text-shadow: 0px 1pt 1pt rgba(0, 0, 0, .333);
        }

        h1, h2, h3, h4, h5, h6 {
            text-align: center;
            text-shadow: 0px .15rem 1pt #fff;
            margin: 4pt 0pt;
        }

        h1 {font-size: 24px;}
        h2 {font-size: 22px;}
        h3 {font-size: 20px;}
        h4 {font-size: 18px;}
        h5 {font-size: 16px;}
        h6 {font-size: 14px;}
    </style>
</head>

<body>
    <div id="content">
        <div id="page">
            <iframe id="pageframe"></iframe>
            <div id="pageHeader" onclick="toggleIndex()" title="Click here to toggle the index panel.">
                <div id="currPageCat" class="pageCount">
                    <div id="currPageNum">…</div>
                </div>
                <div class="pageLabel">
                    <div id="currPageLabel">Loading…</div>
                </div>
            </div>
            <div class="pageBtnContainer">
                <button id="pageBtnPrev" onclick="newPage(currentPage - 1)" disabled> Previous page</button>
                <button id="pageBtnNext" onclick="newPage(currentPage + 1)" disabled>Next page </button>
            </div>
        </div>
        <div id="index">
            <h2 class="hdrspecial">Manual Concepts</h2>
            <h6>Table Of Contents</h6>
            <div id="pageList">
                <div id="pageListC" class="listcontent">
                    <button type="button" onclick="newPage(0,0)">
                        <div class="pageCount cat01">
                            <div>0</div>
                        </div>
                        <div class="pageLabel">
                            Introduction Page
                        </div>
                    </button>
                    <hr>
                </div>
            </div>
            <div class="indexButtons">
                <button id="indexToggle" onclick="toggleIndex()"> Hide</button>
                <button id="indexGetLang" onclick="setLang()"> Language</button>
            </div>
        </div>
    </div>
    <div id="langSel" class="hidden">
        <h3>Language Select</h3>
        <div id="langList">
            <div id="langListC" class="listcontent"></div>
        </div>
        <div class="langButtons">
            <button class="whiteBtn" onclick="reloadData()"> Refresh languages</button>
        </div>
        <div class="langButtons">
            <button class="closeBtn" onclick="hideLangSel()"> Close</button>
        </div>
    </div>
    <script>
        currentPage = 0;
        blockNewPage = false;
        firstLoad = 0;
        firstPage = 0;
        language = 0;

        lang = []
        pages = []
        categories = []

        root = document.querySelector(":root");
        firstLoad = 0;
        function newPage(num) {
            if (num < firstPage) num = firstPage
            if (num >= pages.length || blockNewPage) return;
            blockNewPage = true;
            pageBtnPrev.disabled = true;
            pageBtnNext.disabled = true;
            currPageNum.innerText = num;
            currPageCat.classList = ["pageCount cat" + ((pages[num][2] - 1) % 12 + 1)];
            currPageLabel.innerText = pages[num][0];
            window.setTimeout(function(){
                pageframe.src = "./data/"+pages[num][1];
                currentPage = num;
                pageBtnPrev.disabled = (currentPage <= firstPage);
                pageBtnNext.disabled = (currentPage >= pages.length-1);
            }, 333)
            pageframe.classList = "hidden";
            root.style.setProperty("--pageheader-border-radius", "12px");
        }

        function toggleIndex() {
            let is = getComputedStyle(root).getPropertyValue("--index-bar-width");
            is = Number.parseInt(is.substring(0,is.length-2));
            let i = getComputedStyle(root).getPropertyValue("--index-bar-off");
            i = Number.parseInt(i.substring(0,i.length-2));
            if (!i) {
                i = -is;
                index.classList = "hidden";
            } else {
                i = 0;
                index.classList = "";
            }
            root.style.setProperty("--index-bar-off", i+"px");
        }
        function setIndexToggle(bool) {
            let is = getComputedStyle(root).getPropertyValue("--index-bar-width");
            is = Number.parseInt(is.substring(0,is.length-2));
            let i = getComputedStyle(root).getPropertyValue("--index-bar-off");
            i = Number.parseInt(i.substring(0,i.length-2));
            if (bool) {
                i = -is;
                index.classList = "hidden";
            } else {
                i = 0;
                index.classList = "";
            }
            root.style.setProperty("--index-bar-off", i+"px");
        }

        function setLang() {
            let indiv = document.getElementById("langSel");
            indiv.classList = "";
            //indiv.classList = "hidden";
        }

        function hideLangSel() {
            let indiv = document.getElementById("langSel");
            indiv.classList = "hidden";
        }

        function setLangSel() {
            let indiv = document.getElementById("langSel");
            indiv.classList = "hidden";
            getData()
        }

        function setup() {
            let ccat = 0;
            let ccatR = 0;

            pageListC.innerHTML = "";
            firstPage = 1;
            if (pages[0][1]!="") {
                let b1 = document.createElement("button");
                let d1 = document.createElement("div");
                d1.classList = "pageCount"
                let d11 = document.createElement("div");
                d11.innerText = 0;
                let d2 = document.createElement("div");
                d2.classList = "pageLabel"
                d2.innerText = pages[0][0];
                d1.append(d11);
                b1.append(d1);
                b1.append(d2);
                b1.onclick = function(){newPage(0)};
                pageListC.append(b1);
                b1 = document.createElement("hr");
                pageListC.append(b1);
                firstPage = 0;
            }

            for (let i = 1; i < pages.length; i++) {
                if (categories[i] != null) {
                    if (i > 1) ccat++;
                    let ccatR = ((ccat) % 12 + 1);
                    let d1 = document.createElement("div");
                    d1.classList = "category cat" + ccatR;
                    let d2 = document.createElement("div");
                    d2.innerText = categories[i];;
                    d1.append(d2);
                    pageListC.append(d1);
                }
                let ccatR = ((ccat) % 12 + 1);
                pages[i].push(ccatR);
                let b1 = document.createElement("button");
                let d1 = document.createElement("div");
                d1.classList = "pageCount cat" + ccatR;
                let d11 = document.createElement("div");
                d11.innerText = i;
                let d2 = document.createElement("div");
                d2.classList = "pageLabel"
                d2.innerText = pages[i][0];
                d1.append(d11);
                b1.append(d1);
                b1.append(d2);
                b1.pnum = i;
                b1.onclick = function(){newPage(b1.pnum)};
                pageListC.append(b1);
            }
            if (pages.length < 2) {
                let d1 = document.createElement("div");
                d1.classList = "category cat1";
                let d2 = document.createElement("div");
                d2.classList = "doWrap";
                d2.innerText = "There are no pages present.\nCheck again later.";
                d1.append(d2);
                pageListC.append(d1);
            }
            pageframe.onload = function(){
                if (window.innerWidth < 640) {
                    setIndexToggle(firstLoad);
                }
                blockNewPage = false;
                firstLoad = 1;
                pageframe.classList = "";
                root.style.setProperty("--pageheader-border-radius", "0px");
            }
        }

        function fetchData(url) {
            return fetch(url)
                .then(function(response) {return response.json();})
                .finally(function(json) {return json;})
                .catch(function(err) {console.log(err);})
        };
        function reloadData() {
            lang = [];
            getData();
        }
        function getData() {
            firstLoad = 0;
            root.style.setProperty("--pageheader-border-radius", "12px");
            pageframe.classList = "hidden";
            pageList.classList = "hidden";
            langList.classList = "hidden";
            pageBtnPrev.disabled = true;
            pageBtnNext.disabled = true;
            window.setTimeout(async function(){
                if (!lang.length) {
                    try {
                        await fetchData('./data/lang.json').then((json)=>{lang = json.lang});
                    } finally {
                        langListC.innerHTML = "";
                        for (let i=0; i<lang.length; i++){
                            let b1 = document.createElement("button");
                            let d1 = document.createElement("div");
                            d1.classList = "pageCount"
                            let d11 = document.createElement("div");
                            d11.innerText = "";
                            let d2 = document.createElement("div");
                            d2.classList = "pageLabel"
                            d2.innerText = lang[i][1];
                            d1.append(d11);
                            b1.append(d1);
                            b1.append(d2);
                            b1.onclick = function(){language = i; setLangSel()};
                            langListC.append(b1);
                        }
                    }
                }
                if (language < 0 || language >= lang.length) language = 0
                pages = []
                categories = []
                try {
                    await fetchData('./data/' + lang[language][0] + '.json').then((json)=>{pages = json.pages; categories = json.categories});
                } catch (e) {
                    alert("An error has occured while getting the data:\n\n"+e)
                } finally {
                    await setup();
                    blockNewPage = false;
                    await newPage(0);
                }
                pageList.classList = "";
                langList.classList = "";
            }, 125);
        };

        getData();

    </script>
</body>
</html>